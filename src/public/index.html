<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Agendamento SAE</title>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
</head>
<body>
  <input type="text" id="data" placeholder="Escolha a data">
  <div id="aulas">
    <label><input type="checkbox" value="1"> Aula 1</label>
    <label><input type="checkbox" value="2"> Aula 2</label>
    <label><input type="checkbox" value="3"> Aula 3</label>
    <label><input type="checkbox" value="4"> Aula 4</label>
    <label><input type="checkbox" value="5"> Aula 5</label>
    <label><input type="checkbox" value="6"> Aula 6</label>
  </div>

  <script>
    flatpickr("#data", {
      onChange: function(selectedDates, dateStr) {
        fetch(`ajax/buscar_disponibilidade.php?data=${dateStr}`)
          .then(res => res.json())
          .then(dados => {
            document.querySelectorAll("#aulas input").forEach(chk => {
              chk.disabled = dados.aulas_ocupadas.includes(chk.value);
            });
          });
      }
    });
  </script>
</body>
</html>
